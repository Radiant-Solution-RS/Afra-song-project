{% extends 'base.html' %}
{% load static %}

{% block body_class %}page-artists{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock %}

{% block content %}
<main class="artists-page">
  <div class="layout-grid">

    <!-- Sidebar -->
    <aside class="sidebar">
      <!-- Categories -->
      <div class="sidebar-box">
        <h3>Show Categories</h3>
        <div class="category-list">
          <a href="{% url 'tabs:tabs_list' %}" class="category-item">
            <span>Songs</span>
            <span class="count">{{ counts.songs }}</span>
          </a>
          <a href="{% url 'tabs:albums_list' %}" class="category-item">
            <span>Albums</span>
            <span class="count">{{ counts.albums }}</span>
          </a>
          <a href="{% url 'tabs:artists_list' %}" class="category-item">
            <span>Artists</span>
            <span class="count">{{ counts.artists }}</span>
          </a>
        </div>
      </div>

      <!-- Filters -->
      <div class="sidebar-box">
        <h3>Filters</h3>
        <label for="sortSelect">Sort by</label>
        <select id="sortSelect" class="filter-select">
          <option value="">Default</option>
          <option value="asc" {% if request.GET.sort == 'asc' %}selected{% endif %}>A to Z</option>
          <option value="desc" {% if request.GET.sort == 'desc' %}selected{% endif %}>Z to A</option>
          <option value="recent" {% if request.GET.sort == 'recent' %}selected{% endif %}>Recently Added</option>
          <option value="popular" {% if request.GET.sort == 'popular' %}selected{% endif %}>Most Popular</option>
        </select>
      </div>
    </aside>

    <!-- Artist Cards -->
    <section class="artists-grid">
      {% for artist in page_obj %}
      <div class="artist-card">
        <div class="artist-image">
          {% if artist.artist_img %}
          <img src="{{ artist.artist_img }}" alt="{{ artist.name }}">
          {% else %}
          <div class="artist-placeholder">{{ artist.name|upper|slice:":4" }}</div>
          {% endif %}
        </div>

        <div class="artist-info">
          <h3>
            <a href="{% url 'tabs:artist_detail' artist_slug=artist.name_cleaned %}">
              {{ artist.name }}
            </a>
          </h3>
          <div class="artist-stats">
            <span> Tabs: {{ artist.num_tabs }}</span>
            {% if artist.album_count %}
            <span> Albums: {{ artist.album_count }}</span>
            {% endif %}
            {% if artist.date_added %}
            <span>ðŸ•’ Added: {{ artist.date_added|date:"M d, Y" }}</span>
            {% endif %}
          </div>
        </div>
      </div>
      {% empty %}
      <p class="no-artists">No artists found.</p>
      {% endfor %}
    </section>
  </div>
</main>

<!-- JS: Auto Filter -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const sortSelect = document.getElementById('sortSelect');
  sortSelect.addEventListener('change', () => {
    const params = new URLSearchParams(window.location.search);
    const sort = sortSelect.value;
    if (sort) params.set('sort', sort); else params.delete('sort');
    window.location.search = params.toString();
  });
});
</script>
{% endblock %}
