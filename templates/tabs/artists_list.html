{% extends 'base.html' %}
{% load static %}

{% block body_class %}page-artists{% endblock %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
{% endblock %}

{% block content %}
<main class="artists-main-container">
  <div class="artists-content-grid">

    <!-- Sidebar -->
    <aside class="artists-sidebar">
      <!-- Categories -->
      <div class="category-section">
        <h3 class="section-heading">Show Categories</h3>
        <div class="category-links">
          <a href="{% url 'tabs:tabs_list' %}" class="category-link">
            <span class="category-text">Songs</span>
            <span class="category-count">{{ counts.songs }}</span>
          </a>
          <a href="{% url 'tabs:albums_list' %}" class="category-link">
            <span class="category-text">Albums</span>
            <span class="category-count">{{ counts.albums }}</span>
          </a>
          <a href="{% url 'tabs:artists_list' %}" class="category-link">
            <span class="category-text">Artists</span>
            <span class="category-count">{{ counts.artists }}</span>
          </a>
        </div>
      </div>

      <!-- Filters -->
      <div class="artists-filters-section">
        <h3 class="artists-section-heading">Filters</h3>
        <div class="artists-filter-group">
          <label for="sortSelect" class="artists-filter-label">Sort by</label>
          <select id="sortSelect" class="artists-filter-select">
            <option value="">Default</option>
            <option value="asc" {% if request.GET.sort == 'asc' %}selected{% endif %}>A to Z</option>
            <option value="desc" {% if request.GET.sort == 'desc' %}selected{% endif %}>Z to A</option>
            <option value="recent" {% if request.GET.sort == 'recent' %}selected{% endif %}>Recently Added</option>
            <option value="popular" {% if request.GET.sort == 'popular' %}selected{% endif %}>Most Popular</option>
          </select>
        </div>
      </div>
    </aside>

    <!-- Artist Cards -->
    <section class="artists-section">
      <div class="artists-grid">
        {% for artist in page_obj %}
        <a href="{% url 'tabs:artist_detail' artist_slug=artist.name_cleaned %}" class="artist-card">
          <div class="artist-image">
            {% if artist.artist_img %}
              <img src="{{ artist.artist_img }}" alt="{{ artist.name }}" class="artist-img">
            {% else %}
              <div class="artist-placeholder">
                {{ artist.name|upper|slice:":4" }}
              </div>
            {% endif %}
          </div>

          <div class="artist-info">
            <h2 class="artist-name">{{ artist.name }}</h2>
            <p class="artist-slug">{{ artist.name_cleaned }}</p>
            <p class="artist-tab-count">Tabs: {{ artist.num_tabs }}</p>
          </div>
        </a>
        {% empty %}
        <p class="artists-empty">No artists found.</p>
        {% endfor %}
      </div>
    </section>
  </div>
</main>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
document.addEventListener('DOMContentLoaded', () => {
  const sortSelect = document.getElementById('sortSelect');
  sortSelect.addEventListener('change', () => {
    const params = new URLSearchParams(window.location.search);
    const sort = sortSelect.value;
    if (sort) params.set('sort', sort); else params.delete('sort');
    window.location.search = params.toString();
  });
});
</script>
{% endblock %}
