{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
{% endblock %}

{% block content %}
<main class="albums-main-container">
  <div class="albums-content-grid">
    <aside class="albums-sidebar">
     <div class="category-section">
        <h3 class="section-heading">Show Categories</h3>
        <div class="category-links">
          <a href="{% url 'tabs:tabs_list' %}" class="category-link">
            <span class="category-text">Songs</span>
            <span class="category-count">{{ counts.songs }}</span>
          </a>
          <a href="{% url 'tabs:albums_list' %}" class="category-link">
            <span class="category-text">Albums</span>
            <span class="category-count">{{ counts.albums }}</span>
          </a>
          <a href="{% url 'tabs:artists_list' %}" class="category-link">
            <span class="category-text">Artists</span>
            <span class="category-count">{{ counts.artists }}</span>
          </a>
        </div>
      </div>
      <div class="albums-filters-section">
        <h3 class="albums-section-heading">Filters</h3>
        <form method="GET" class="albums-filter-form">
          <div class="albums-filter-group">
            <label class="albums-filter-label">Name (A - Z)</label>
            <select name="sort" class="albums-filter-select" onchange="this.form.submit()">
              <option value="A to Z" {% if sort_by == 'A to Z' %}selected{% endif %}>A to Z</option>
              <option value="Z to A" {% if sort_by == 'Z to A' %}selected{% endif %}>Z to A</option>
              <option value="Recently Added" {% if sort_by == 'Recently Added' %}selected{% endif %}>Recently Added</option>
              <option value="Most Popular" {% if sort_by == 'Most Popular' %}selected{% endif %}>Most Popular</option>
            </select>
          </div>
           <div class="filter-group">
          <label class="filter-label">Tuning</label>
          <select id="tuningSelect" class="filter-select">
            <option value="All Tunings" {% if not tuning_filter or tuning_filter == "All Tunings" %}selected{% endif %}>All Tunings</option>
            <option value="E Standard" {% if tuning_filter == "E Standard" %}selected{% endif %}>E Standard</option>
            <option value="Drop D" {% if tuning_filter == "Drop D" %}selected{% endif %}>Drop D</option>
            <option value="Drop C" {% if tuning_filter == "Drop C" %}selected{% endif %}>Drop C</option>
            <option value="Drop B" {% if tuning_filter == "Drop B" %}selected{% endif %}>Drop B</option>
            <option value="DADGAD" {% if tuning_filter == "DADGAD" %}selected{% endif %}>DADGAD</option>
          </select>
        </div>
          {% if search_query %}
            <input type="hidden" name="search" value="{{ search_query }}">
          {% endif %}
        </form>
      </div>
    </aside>
    <section class="albums-section">
      <div class="albums-list-grid">
        {% for album in page_obj %}
        <div class="albums-album-card">
          <div class="albums-album-image">
            <img src="{{ album.album_img }}" alt="{{ album.title }}" class="albums-album-img">
            {% if album.is_complete %}<span class="albums-album-badge albums-album-badge-complete">Complete</span>{% endif %}
            {% if album.has_filler %}<span class="albums-album-badge albums-album-badge-filler">Filler</span>{% endif %}
          </div>
          <div class="albums-album-info">
            <div class="albums-album-details">
              <h3 class="albums-album-title">
                <a class="albums-album-link" href="{% url 'tabs:album_detail' artist_slug=album.artist.name_cleaned album_slug=album.title_cleaned %}">{{ album.title }}</a>
              </h3>
              <div class="albums-album-artist-year">
                <span class="albums-album-artist">{{ album.artist.name }}</span>
                <span class="albums-album-year">{{ album.release_year }}</span>
              </div>
            </div>
            <div class="albums-album-footer">
              <span class="albums-album-tab-count">{{ album.song_count }} Tab{{ album.tab_count|pluralize }}</span>
              {% if album.tuning %}
              <span class="albums-album-tuning" title="Primary tuning">{{ album.tuning }}</span>
              {% endif %}
            </div>
          </div>
        </div>
        {% empty %}
          <p class="albums-empty">No albums found.</p>
        {% endfor %}
      </div>
      {% if page_obj.has_other_pages %}
      <div class="albums-pagination">
        {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}" class="albums-pagination-btn albums-pagination-prev">Prev</a>
        {% endif %}
        <span class="albums-pagination-current">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}" class="albums-pagination-btn albums-pagination-next">Next</a>
        {% endif %}
      </div>
      {% endif %}
    </section>
  </div>
</main>
{% endblock %}