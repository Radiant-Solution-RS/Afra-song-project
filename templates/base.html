{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=Libre+Caslon+Text:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">
    <title>{% block title %}Afra's Tabs - Guitar Tablatures{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: {
                            primary: '#141414',
                            secondary: '#1A1A1A',
                            tertiary: '#222222',
                            light: '#4a90e2',
                            card: 'rgba(255, 255, 255, 0.04)',
                            cardHover: 'rgba(255, 255, 255, 0.08)',
                            border: 'rgba(255, 255, 255, 0.1)',
                            text: '#cfcfcf',
                            accent: '#357abd'
                        }
                    },
                    backgroundImage: {
                        'gradient-primary': 'linear-gradient(135deg, #0E0E0E 0%, #1A1A1A 50%, #222222 100%)',
                        'gradient-card-1': 'linear-gradient(135deg, #8B4513, #2F1B0C)',
                        'gradient-card-2': 'linear-gradient(135deg, #708090, #2F4F4F)',
                        'gradient-card-3': 'linear-gradient(135deg, #1C1C1C, #000000)',
                        'gradient-card-4': 'linear-gradient(135deg, #4169E1, #191970)',
                    }
                }
            }
        }
    </script>
    {% block extra_css %}
    <style type="text/tailwindcss">
        @layer utilities {
            .text-4xl {
                     font-family: "IM Fell English", serif;
                     font-weight: 400;
                     font-style: normal;
            
            }
            .body {
                font-family: "Libre Caslon Text", serif;
                font-weight: 400;
                font-style: normal;
            }
            .text-xl {
                font-family: "Libre Caslon Text", serif;
                font-weight: 400;
                font-style: normal;
                font-size: 15px;
            }
            
            .leading-tight {
                font-family: "im fell english", serif;
                font-weight: 400;
                font-style: normal;
                font-size: 17px;
            }
            
        }
    </style>
    {% endblock %}
</head>

<body class="bg-gradient-primary text-white min-h-screen font-['Times_New_Roman',_Times,_serif] leading-relaxed {% block body_class %}{% endblock %}">
    <header class="py-5 border-b border-dark-border">
        <div class="container mx-auto px-5 max-w-6xl">
            <nav class="flex justify-between items-center flex-wrap gap-5">
                <a href="{% url 'tabs:index' %}" class="font-im-fell text-4xl font-semibold text-white no-underline">Afra's Tabs</a>
                <ul class="flex list-none gap-10">
                    <li><a href="{% url 'tabs:tabs_list' %}"
                            class="text-dark-text no-underline transition-colors duration-300 hover:text-dark-light">Tabs</a>
                    </li>
                    <li><a href="#"
                            class="text-dark-text no-underline transition-colors duration-300 hover:text-dark-light">Make
                            a request</a></li>
                    <li><a href="{% url 'tabs:about' %}"
                            class="text-dark-text no-underline transition-colors duration-300 hover:text-dark-light">About</a>
                    </li>
                </ul>
                <div class="relative">
                    <input type="text" id="search-input" name="search" value="{{ request.GET.search }}"
                        class="bg-[rgba(255,255,255,0.1)] border border-dark-border rounded-md py-2.5 px-5 text-white min-w-64 outline-none placeholder:opacity-60"
                        placeholder="Search for songs, albums, artists" autocomplete="off">
                    <div id="search-dropdown" class="absolute top-full left-0 right-0 bg-dark-card border border-dark-border rounded-md mt-1 hidden z-50 max-h-80 overflow-y-auto">
                        
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main>
        {% block content %}
        {% endblock %}
    </main>

    <footer class="mt-25 pt-15 pb-10 border-t border-dark-border text-center">
        <div class="container mx-auto px-5 max-w-6xl">
            <div class="text-4xl font-semibold mb-5 mt-10">Afra's Tabs</div>
            <p class="text-dark-text max-w-3xl mx-auto mb-10">
                All guitar tablatures are created for educational and personal use only.<br>
                Original songs and compositions are copyrighted by their respective owners.
            </p>
            <div
                class="flex flex-col md:flex-row justify-between items-center pt-7.5  border-t border-dark-border text-gray-400 text-sm">
                <div>Â© 2025 Afra's Tabs. All rights reserved.</div>
                <a href="#" class="text-dark-text text-xl transition-colors duration-300 hover:text-dark-light mt-5">ðŸŽµ</a>
            </div>
        </div>
    </footer>

    {% block extra_js %}
    <script>
        
        const searchInput = document.getElementById('search-input');
        const searchDropdown = document.getElementById('search-dropdown');
        let searchTimeout;
        
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                const query = this.value.trim();
                
                clearTimeout(searchTimeout);
                
                if (query.length < 2) {
                    searchDropdown.classList.add('hidden');
                    return;
                }
                
                searchTimeout = setTimeout(() => {
                    fetch(`{% url 'tabs:search_api' %}?q=${encodeURIComponent(query)}`)
                        .then(response => response.json())
                        .then(data => {
                            displaySearchResults(data.results);
                        })
                        .catch(error => {
                            console.error('Search error:', error);
                        });
                }, 300);
            });
            
            searchInput.addEventListener('blur', function() {
                
                setTimeout(() => {
                    searchDropdown.classList.add('hidden');
                }, 200);
            });
            
            searchInput.addEventListener('focus', function() {
                if (this.value.trim().length >= 2) {
                    searchDropdown.classList.remove('hidden');
                }
            });
        }
        
        function displaySearchResults(results) {
            if (results.length === 0) {
                searchDropdown.classList.add('hidden');
                return;
            }
            
            const html = results.map(result => {
                const typeIcon = result.type === 'song' ? 'ðŸŽµ' : 
                               result.type === 'album' ? 'ðŸ’¿' : 'ðŸŽ¤';
                const verifiedIcon = result.verified ? '<svg class="w-4 h-4 text-green-500 inline ml-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>' : '';
                
                return `
                    <a href="${result.url}" class="block p-3 hover:bg-dark-cardHover transition-colors border-b border-dark-border last:border-b-0">
                        <div class="flex items-center gap-3">
                            <span class="text-lg">${typeIcon}</span>
                            <div class="flex-1">
                                <div class="font-medium text-white flex items-center">
                                    ${result.title}${verifiedIcon}
                                </div>
                                <div class="text-sm text-gray-400">${result.subtitle}</div>
                            </div>
                        </div>
                    </a>
                `;
            }).join('');
            
            searchDropdown.innerHTML = html;
            searchDropdown.classList.remove('hidden');
        }
        
        
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.relative')) {
                searchDropdown.classList.add('hidden');
            }
        });
    </script>
    {% endblock %}
</body>

</html>